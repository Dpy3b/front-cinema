(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{60091:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage/movie/edit/[id]",function(){return n(47966)}])},25479:function(e,r,n){"use strict";n.d(r,{c:function(){return c}});var t=n(34051),o=n.n(t),u=n(84714),i=n(33739);function a(e,r,n,t,o,u,i){try{var a=e[u](i),s=a.value}catch(c){return void n(c)}a.done?r(s):Promise.resolve(s).then(t,o)}function s(e){return function(){var r=this,n=arguments;return new Promise((function(t,o){var u=e.apply(r,n);function i(e){a(u,t,o,i,s,"next",e)}function s(e){a(u,t,o,i,s,"throw",e)}i(void 0)}))}}var c={getBySlug:function(e){return s(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",u.v.get((0,i.V8)("/by-slug/".concat(e))));case 1:case"end":return r.stop()}}),r)})))()},create:function(){return s(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.Z.post((0,i.V8)("")));case 1:case"end":return e.stop()}}),e)})))()},update:function(e,r){return s(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",u.Z.put((0,i.V8)("/".concat(e)),r));case 1:case"end":return n.stop()}}),n)})))()},delete:function(e){return s(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",u.Z.delete((0,i.V8)("/".concat(e))));case 1:case"end":return r.stop()}}),r)})))()},getAll:function(e){return s(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",u.v.get((0,i.V8)(""),{params:e?{searchTerm:e}:{}}));case 1:case"end":return r.stop()}}),r)})))()},getCollections:function(){return s(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.v.get((0,i.V8)("/collections")));case 1:case"end":return e.stop()}}),e)})))()},getById:function(e){return s(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",u.Z.get((0,i.V8)("/".concat(e))));case 1:case"end":return r.stop()}}),r)})))()},getPopularGenres:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return s(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",u.v.get((0,i.V8)("/popular"),{params:{limit:e}}));case 1:case"end":return r.stop()}}),r)})))()}}},47966:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return A}});var t=n(85893),o=n(5152),u=n(87536),i=n(11854),a=n.n(i),s=n(36604),c=n(10073),l=n(73789),d=n(344),f=n(96430),p=n(62289),v=n(6884),m=n(71499),g=n(85219),h=n(88767),w=n(1854),x=n(75777),b=n(25479),y=n(34051),j=n.n(y),_=n(11163),q=n(16938),P=n(83618),Z=n(96228),S=n(60590);function V(e,r,n,t,o,u,i){try{var a=e[u](i),s=a.value}catch(c){return void n(c)}a.done?r(s):Promise.resolve(s).then(t,o)}var k=function(e){var r=(0,_.useRouter)(),n=r.query,t=r.push,o=String(n.id),u=(0,h.useQuery)(["movie",o],(function(){return P.u.getById(o)}),{onSuccess:function(r){var n=r.data;(0,Z.R)(n).forEach((function(r){e(r,n[r])}))},onError:function(e){(0,x._)(e,"Get movie")},enabled:!!n.id}).isLoading,i=(0,h.useMutation)("update movie",(function(e){return P.u.update(o,e)}),{onError:function(e){(0,x._)(e,"Update movie")},onSuccess:function(){q.Rt.success("Update movie","update was successful"),t((0,S.A7)("movies"))}}).mutateAsync;return{onSubmit:function(){var e,r=(e=j().mark((function e(r){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(r);case 2:case"end":return e.stop()}}),e)})),function(){var r=this,n=arguments;return new Promise((function(t,o){var u=e.apply(r,n);function i(e){V(u,t,o,i,a,"next",e)}function a(e){V(u,t,o,i,a,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}(),isLoading:u}};function E(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function C(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){E(e,r,n[r])}))}return e}var O=(0,o.default)((function(){return Promise.all([n.e(766),n.e(336)]).then(n.bind(n,33336))}),{loadableGenerated:{webpack:function(){return[33336]}},ssr:!1}),N=function(){var e,r,n,o=(0,u.cI)({mode:"onChange"}),i=o.handleSubmit,y=o.register,j=o.formState.errors,_=o.control,q=o.setValue,P=o.getValues,Z=k(q),S=Z.onSubmit,V=Z.isLoading,E=(0,h.useQuery)("list of genre",(function(){return b.c.getAll()}),{select:function(e){return e.data.map((function(e){return{label:e.name,value:e._id}}))},onError:function(e){(0,x._)(e,"genre list")}}),N=E.data,Q=E.isLoading,A=(0,h.useQuery)("list of actor",(function(){return w.V.getAll()}),{select:function(e){return e.data.map((function(e){return{label:e.name,value:e._id}}))},onError:function(e){(0,x._)(e,"actor list")}}),L=A.data,T=A.isLoading;return(0,t.jsxs)(m.h,{title:"Edit movie",children:[(0,t.jsx)(s.Z,{}),(0,t.jsx)(p.Z,{title:"Edit movie"}),V?(0,t.jsx)(v.Z,{count:5}):(0,t.jsxs)("form",{onSubmit:i(S),className:a().form,children:[(0,t.jsxs)("div",{className:a().fields,children:[(0,t.jsx)(l.Z,C({},y("title",{required:"Title is required!"}),{placeholder:"Title",error:j.title})),(0,t.jsx)(d.Z,{generate:function(){return q("slug",(0,g.Z)(P("title")))},register:y,error:j.slug}),(0,t.jsx)(l.Z,C({},y("parameters.country",{required:"Country is required!"}),{placeholder:"Country",error:null===(e=j.parameters)||void 0===e?void 0:e.country,style:{width:"31%"}})),(0,t.jsx)(l.Z,C({},y("parameters.duration",{required:"Duration is required!"}),{placeholder:"Duration (min.)",error:null===(r=j.parameters)||void 0===r?void 0:r.duration,style:{width:"31%"}})),(0,t.jsx)(l.Z,C({},y("parameters.year",{required:"Year is required!"}),{placeholder:"Year",error:null===(n=j.parameters)||void 0===n?void 0:n.year,style:{width:"31%"}})),(0,t.jsx)(u.Qr,{name:"genres",control:_,rules:{required:"Please select at least one genre!"},render:function(e){var r=e.field,n=e.fieldState.error;return(0,t.jsx)(O,{error:n,field:r,placeholder:"Genres",options:N||[],isLoading:Q,isMulti:!0})}}),(0,t.jsx)(u.Qr,{name:"actors",control:_,rules:{required:"Please select at least one actor!"},render:function(e){var r=e.field,n=e.fieldState.error;return(0,t.jsx)(O,{error:n,field:r,placeholder:"Actors",options:L||[],isLoading:T,isMulti:!0})}}),(0,t.jsx)(u.Qr,{name:"poster",control:_,defaultValue:"",render:function(e){var r=e.field,n=r.value,o=r.onChange,u=e.fieldState.error;return(0,t.jsx)(f.Z,{placeholder:"Poster",error:u,folder:"movies",image:n,onChange:o})},rules:{required:"Poster is required!"}}),(0,t.jsx)(u.Qr,{name:"bigPoster",control:_,defaultValue:"",render:function(e){var r=e.field,n=r.value,o=r.onChange,u=e.fieldState.error;return(0,t.jsx)(f.Z,{placeholder:"Big poster",error:u,folder:"movies",image:n,onChange:o})},rules:{required:"Big poster is required!"}}),(0,t.jsx)(u.Qr,{name:"videoUrl",control:_,defaultValue:"",render:function(e){var r=e.field,n=r.value,o=r.onChange,u=e.fieldState.error;return(0,t.jsx)(f.Z,{placeholder:"Video",error:u,folder:"movies",image:n,onChange:o,style:{marginTop:-25},isNoImage:!0})},rules:{required:"Video is required!"}})]}),(0,t.jsx)(c.Z,{children:"Update"})]})]})},Q=function(){return(0,t.jsx)(N,{})};Q.isOnlyAdmin=!0;var A=Q}},function(e){e.O(0,[536,99,774,888,179],(function(){return r=60091,e(e.s=r);var r}));var r=e.O();_N_E=r}]);